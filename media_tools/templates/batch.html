{% extends "base.html" %}

{% block title %}Batch Image Processing{% endblock %}

{% block content %}
    <h1>Batch Image Processing</h1>
    <p>Upload multiple images to process them at once.</p>

    <form action="{{ url_for('batch') }}" method="post" enctype="multipart/form-data">
        <div class="form-group">
            <label for="files">Select Images:</label>
            <input type="file" id="files" name="files[]" multiple accept=".png,.jpg,.jpeg,.gif,.webp,.bmp">
        </div>

        <div class="form-group">
            <label for="batch-format">Convert all to:</label>
            <select id="batch-format" name="format">
                <option value="png">PNG</option>
                <option value="jpg">JPG</option>
                <option value="webp">WebP</option>
                <option value="gif">GIF</option>
                <option value="bmp">BMP</option>
            </select>
        </div>

        <div class="toggle-container">
            <label>
                <input type="checkbox" id="batch-resize-toggle"> Resize all images
            </label>
        </div>

        <div id="batch-resize-options" class="form-group hidden">
            <input type="hidden" name="resize" id="batch-resize" value="no">
            <div class="form-group">
                <label for="batch-width">Width (px):</label>
                <input type="number" id="batch-width" name="width" placeholder="Leave empty to maintain aspect ratio">
            </div>
            <div class="form-group">
                <label for="batch-height">Height (px):</label>
                <input type="number" id="batch-height" name="height" placeholder="Leave empty to maintain aspect ratio">
            </div>
        </div>

        <div class="form-group">
            <button type="submit">Process & Download</button>
        </div>
    </form>
    <p><em>Note: This is a demo version. In a full implementation, processed files would be zipped together for download.</em></p>
{% endblock %}

{% block scripts %}
<script>
    // Handle resize toggle for batch
    const batchResizeToggle = document.getElementById('batch-resize-toggle');
    const batchResizeOptions = document.getElementById('batch-resize-options');
    const batchResizeInput = document.getElementById('batch-resize');

    batchResizeToggle.addEventListener('change', function() {
        if (this.checked) {
            batchResizeOptions.classList.remove('hidden');
            batchResizeInput.value = 'yes';
        } else {
            batchResizeOptions.classList.add('hidden');
            batchResizeInput.value = 'no';
        }
    });
</script>
{% endblock %}